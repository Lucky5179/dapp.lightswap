const __vite__fileDeps=["assets/index-POi8GhpC.js","assets/index-CWjS2nv2.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{cn as t,df as je,_ as ae,fn as R,cv as e,cJ as s,cP as v,cA as a,cM as E,cz as o,cy as w,dJ as ne,F as k,fo as we,fp as ye,dM as re,cT as be,dK as ke,cO as Te,cI as V,L as C,dt as ve,dd as Ce,O as le,fq as ie,eg as Ne,ei as $,cL as I,cR as Se,fr as Ve,fi as _e,__tla as Oe}from"./assets/index-POi8GhpC.js";import{I as He}from"./CYwjOChi.js";import{T as Re}from"./CJGo2KxJ.js";import{V as Ee}from"./BNG_iicX.js";import{V as ce}from"./DXIISF2l.js";import{u as F,S as u,a as Ie,__tla as Ae}from"./CeesTFZ8.js";import{C as oe}from"./DLtD_L4G.js";import{C as De,__tla as We}from"./Bujnyu6O.js";import{t as K}from"./CTyLih9z.js";import"./DtctggWu.js";import"./Bb0RDO2T.js";let fe,ze=Promise.all([(()=>{try{return Oe}catch{}})(),(()=>{try{return Ae}catch{}})(),(()=>{try{return We}catch{}})()]).then(async()=>{(function(){try{var l=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},n=new l.Error().stack;n&&(l._sentryDebugIds=l._sentryDebugIds||{},l._sentryDebugIds[n]="9b7fc0fc-dff2-44fe-b0e6-2a01fde05781",l._sentryDebugIdIdentifier="sentry-dbid-9b7fc0fc-dff2-44fe-b0e6-2a01fde05781")}catch{}})(),BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),BigInt("1000000000000000000"),BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),BigInt("0x8000000000000000000000000000000000000000000000000000000000000000")*BigInt(-1);let U,q,J,Y,X,G,Q;U=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),q=t.memo(({action:l,assetValue:n,disabledButton:d,ethAddress:r,handleVthorAction:p,setIsConnectModalOpen:m})=>{const[y,f]=t.useState(!1),{approveTHOR:N}=F(),g=t.useCallback(async()=>{var b;const{getWallet:T}=await(await je(()=>import("./assets/index-POi8GhpC.js").then(async i=>(await i.__tla,i)).then(i=>i.hc),__vite__mapDeps([0,1]))).getSwapKitClient(),x=T(ae.Ethereum);if(!(x&&r))return;const S=await((b=x==null?void 0:x.isApproved)==null?void 0:b.call(x,{from:r,spenderAddress:R[ce.VTHOR],assetAddress:R[ce.THOR],amount:n.bigIntValue||U}));f(!!S)},[n.bigIntValue,r]);return t.useEffect(()=>{g()},[g]),e.jsx(s,{className:"self-stretch pt-5",children:r?e.jsx(s,{className:"w-full",children:l===u.Deposit?e.jsx(e.Fragment,{children:y?e.jsx(v,{stretch:!0,disabled:d,onClick:p,size:"lg",variant:"fancy",children:a("txManager.stake")}):e.jsx(v,{stretch:!0,loading:!1,onClick:N,size:"lg",variant:"fancy",children:a("txManager.approve")})}):e.jsx(v,{stretch:!0,disabled:d,onClick:p,size:"lg",variant:"fancy",children:a("views.stakingVThor.unstake")})}):e.jsx(v,{stretch:!0,onClick:()=>m(!0),size:"lg",variant:"fancy",children:a("common.connectWallet")})})}),J=({outputAmount:l,stakingAsset:n,handleAction:d,closeModal:r,isOpened:p,outputAsset:m})=>{const y=t.useCallback(()=>{r(),d()},[r,d]);return e.jsx(De,{inputAssets:[n],isOpened:p,onClose:r,onConfirm:y,children:e.jsx(s,{className:"w-full",children:e.jsxs(s,{alignCenter:!0,row:!0,className:"w-full",justify:"between",children:[e.jsxs(s,{center:!0,col:!0,className:"flex-1 p-4 rounded-2xl",children:[e.jsx(E,{asset:n}),e.jsx(s,{center:!0,className:"pt-2",children:e.jsx(oe,{asset:n})}),e.jsx(s,{center:!0,className:"w-full",children:e.jsxs(o,{fontWeight:"medium",textStyle:"caption",children:[n.toSignificant(6)," ",n.ticker]})})]}),e.jsx(w,{className:"mx-2 -rotate-90",name:"arrowDown"}),e.jsxs(s,{center:!0,col:!0,className:"flex-1 p-4 rounded-2xl",children:[e.jsx(E,{asset:m}),e.jsx(s,{center:!0,className:"pt-2",children:e.jsx(oe,{asset:m})}),e.jsx(s,{center:!0,className:"w-full",children:e.jsxs(o,{fontWeight:"medium",textStyle:"caption",children:[l," ",m.ticker]})})]})]})})})},Y=t.memo(({walletType:l})=>{const n=t.useCallback(async()=>{var d,r;await((r=l===ne.CTRL?(d=window.xfi)==null?void 0:d.ethereum:window.ethereum)==null?void 0:r.request({method:"wallet_watchAsset",params:{type:"ERC20",options:{address:R.VTHOR,symbol:"vTHOR",decimals:k.ETH,image:we("vthor","png")}}}))},[l]);return e.jsx(v,{onClick:n,rightIcon:e.jsx(w,{name:"metamask",size:16}),textTransform:"none",variant:"outlineTint",children:a("views.stakingVThor.addVTHOR")})}),X=t.memo(({walletType:l,ethAddress:n})=>{const[d,r]=t.useState(!1),[p,m]=t.useState(!0),{getRate:y,stakePercentageRate:f,thorStaked:N,vthorBalance:g,handleRefresh:T}=F(),{hasStakedV1Thor:x}=Ie(n),S=t.useCallback(()=>{r(!0),T(),setTimeout(()=>r(!1),1e3)},[T]),{data:b}=ye(),i=b==null?void 0:b.apr;return t.useEffect(()=>{m(x)},[x]),e.jsxs(s,{col:!0,className:"mt-5 gap-2",children:[p&&e.jsx(re,{content:e.jsxs(e.Fragment,{children:[a("views.stakingVThor.stakeInfoDescription"),e.jsx(be,{className:"text-twitter-blue",to:ke.LegacyStake,children:a("views.stakingVThor.goToUnstake")})]}),onClose:()=>m(!1),title:a("views.stakingVThor.stakeInfoTitle"),type:"warn"}),e.jsx(re,{type:"info",children:e.jsxs(s,{col:!0,className:"self-stretch gap-3 px-3 py-1",children:[e.jsxs(s,{alignCenter:!0,row:!0,className:"pb-2 border-0 border-b border-solid border-opacity-20 border-light-border-primary dark:border-dark-border-primary",justify:"between",children:[e.jsx(o,{fontWeight:"semibold",textStyle:"subtitle2",children:a("views.stakingVThor.statTitle")}),e.jsxs(s,{alignCenter:!0,row:!0,className:"gap-2",children:[e.jsx(Y,{walletType:l}),e.jsx(Te,{iconName:"refresh",onClick:S,spin:d})]})]}),e.jsxs(s,{alignCenter:!0,row:!0,className:"gap-2",justify:"between",children:[e.jsxs(s,{alignCenter:!0,row:!0,className:"gap-x-1",children:[e.jsx(o,{fontWeight:"medium",textStyle:"caption",variant:"secondary",children:a("views.stakingVThor.stakingApy")}),e.jsx(V,{className:"cursor-pointer",content:a("views.stakingVThor.apyTip"),children:e.jsx(w,{color:"primaryBtn",name:"infoCircle",size:16})})]}),e.jsxs(s,{alignCenter:!0,row:!0,className:"gap-2",children:[e.jsx(o,{fontWeight:"medium",textStyle:"subtitle2",children:i&&i.total>0?`${K(i.total,3)}%`:"-"}),e.jsx(V,{className:"cursor-pointer",content:`Real yield: ${K((i==null?void 0:i.realYield)??0,3)}%
                Emissions: ${K((i==null?void 0:i.emissions)??0,3)}%
              `,children:e.jsx(w,{color:"primaryBtn",name:"infoCircle",size:16})})]})]}),e.jsxs(s,{alignCenter:!0,row:!0,className:"gap-2",justify:"between",children:[e.jsxs(s,{alignCenter:!0,row:!0,className:"gap-x-1",children:[e.jsx(o,{fontWeight:"medium",textStyle:"caption",variant:"secondary",children:a("views.stakingVThor.totalStaked")}),e.jsx(V,{className:"cursor-pointer",content:a("views.stakingVThor.totalThorTip"),children:e.jsx(w,{color:"primaryBtn",name:"infoCircle",size:16})})]}),e.jsxs(o,{fontWeight:"medium",textStyle:"subtitle2",children:[N.toAbbreviation()," / ",f,"%"]})]}),e.jsxs(s,{alignCenter:!0,row:!0,className:"gap-2",justify:"between",children:[e.jsx(s,{alignCenter:!0,row:!0,className:"gap-x-1",children:e.jsx(o,{fontWeight:"medium",textStyle:"caption",variant:"secondary",children:a("views.stakingVThor.redeemableBalance")})}),e.jsx(o,{fontWeight:"medium",textStyle:"subtitle2",children:g.gt(0)?`${g.mul(y()).toCurrency("")} / ${g.toCurrency("")}`:"-"})]})]})})]})}),G=async(l,n)=>{try{const d=await(await _e(R[l])).balanceOf(n);return C.fromBigInt(d,k.ETH)}catch{return new C({value:0,decimal:k.ETH})}},Q=()=>{const l=[{label:a("views.stakingVThor.stakeVThor"),value:u.Deposit},{label:a("views.stakingVThor.unstake"),value:u.Unstake}],[n,d]=t.useState(u.Deposit),[r,p]=t.useState(new C({value:0,decimal:k.ETH})),[m,y]=t.useState(new C({value:0,decimal:k.ETH})),[f,N]=t.useState(new C({value:0,decimal:k.ETH})),[g,T]=t.useState("0"),[x,S]=t.useState(!0),[b,i]=t.useState(!1),{getRateString:de,previewDeposit:_,previewRedeem:O,stakeThor:Z,unstakeThor:ee}=F(),{setIsConnectModalOpen:me}=ve(),{getWallet:se}=Ce(),h=t.useMemo(()=>n===u.Deposit,[n]),[H,A]=t.useMemo(()=>[le.fromChainOrSignature(h?"ETH.THOR":"ETH.vTHOR"),le.fromChainOrSignature(h?"ETH.vTHOR":"ETH.THOR")],[h]),{walletType:D,address:j}=t.useMemo(()=>se(ae.Ethereum)||{walletType:void 0,address:void 0},[se]),W=t.useCallback(async(c,P,L)=>{const te=await G(c,P);L==="thor"?p(te):y(te)},[]);t.useEffect(()=>{j?(W(ie.THOR,j,"thor"),W(ie.VTHOR,j,"vthor")):(p(new C({value:0,decimal:k.ETH})),y(new C({value:0,decimal:k.ETH})))},[j,W]);const he=t.useCallback(()=>{const c=h?r:m;N(c),T(h?_(c):O(c))},[h,r,m,_,O]),z=t.useCallback((c,P)=>{N(c);const L=P===u.Deposit?_(c):O(c);T(L)},[_,O]),B=t.useCallback(()=>{j&&(h?Z:ee)(f,j)},[j,f,h,Z,ee]),xe=t.useCallback(()=>{D===ne.KEYSTORE?i(!0):B()},[D,B]),ue=t.useCallback(()=>{i(!1)},[]),M=t.useCallback(c=>{d(c),S(c!==u.Deposit),z(f,c)},[f,z]),pe=t.useCallback(()=>{M(n===u.Deposit?u.Unstake:u.Deposit)},[n,M]),ge=t.useMemo(()=>f.lte(0)||h&&f.gt(r)||!h&&f.gt(m),[f,h,r,m]);return e.jsxs(s,{col:!0,className:"self-center w-full max-w-[480px] mt-2",children:[e.jsx(Ne,{content:a("views.stakingVThor.description"),keywords:"THOR, vTHOR, Staking, LIGHTSwap AI, DEFI, DEX",title:a("views.stakingVThor.title")}),e.jsx(Ee,{title:a("views.stakingVThor.stakeVThorTitle")}),e.jsxs(s,{alignCenter:!0,className:"px-3",justify:"between",children:[e.jsx(o,{fontWeight:"medium",textStyle:"caption",variant:"secondary",children:a("views.stakingVThor.stakeVThorSubtitle")}),e.jsx(V,{content:a("views.stakingVThor.stakeInfo"),place:"bottom",children:e.jsx(w,{color:"primaryBtn",name:"infoCircle",size:24})})]}),e.jsx(X,{ethAddress:j,walletType:D}),e.jsxs($,{stretch:!0,className:"!rounded-2xl md:!rounded-3xl !p-4 flex-col items-center self-stretch mt-2 space-y-1 shadow-lg md:w-full md:h-auto",size:"lg",children:[e.jsx(s,{className:"self-stretch",children:e.jsx(Re,{onChange:M,tabs:l,value:n})}),e.jsxs(s,{className:"relative self-stretch",children:[e.jsx(s,{center:!0,className:I("z-10 absolute -mt-0.5 -bottom-6 left-1/2 -translate-x-1/2","p-1 md:p-2 rounded-xl md:rounded-[18px] cursor-pointer","border-10 border-solid bg-blue dark:border-dark-border-primary border-transparent hover:brightness-125 transition"),onClick:pe,children:e.jsx(w,{className:I("p-1 transition-all",{"-scale-x-100":h}),color:"white",name:"arrowDown",size:20})}),e.jsx(Se,{className:I("!gap-1 !justify-start flex-1 !px-4 md:!px-6 !py-4"),children:e.jsxs(s,{alignCenter:!0,col:!0,className:"self-stretch flex-1 md:pl-0",children:[e.jsx(s,{className:"gap-3 self-stretch !mb-3",children:e.jsxs(s,{alignCenter:!0,flex:1,justify:"between",children:[e.jsx(o,{className:"-ml-1",fontWeight:"normal",variant:"secondary",children:a("views.stakingVThor.send")}),e.jsxs(s,{center:!0,row:!0,className:"gap-1 pr-2 md:pr-0",children:[e.jsxs(o,{fontWeight:"medium",variant:"secondary",children:[a("common.balance"),":"," ",h?r.toSignificant(6):m.toSignificant(6)]}),e.jsx(v,{className:"!h-5 !px-1.5",onClick:he,textTransform:"uppercase",variant:"outlineSecondary",children:a("common.max")})]})]})}),e.jsxs(s,{className:"self-stretch flex-1",children:[e.jsx(s,{flex:1,children:e.jsx(He,{stretch:!0,amountValue:f,className:I("-ml-1 !text-2xl font-normal text-left flex-1"),containerClassName:"!py-0",onAmountChange:c=>z(c,n)})}),e.jsxs(s,{center:!0,className:"gap-3",children:[e.jsx(o,{textStyle:"subtitle2",children:H.ticker}),e.jsx(E,{asset:H,size:34})]})]})]})})]}),e.jsx($,{className:"!bg-light-bg-primary dark:!bg-dark-gray-light !rounded-2xl self-stretch !py-3 gap-2 justify-between md:px-6",children:e.jsxs(s,{col:!0,className:"self-stretch flex-1 md:pl-0",children:[e.jsx(s,{className:"gap-3 self-stretch !mb-3",children:e.jsxs(o,{className:"-ml-1",fontWeight:"normal",variant:"secondary",children:[a("views.stakingVThor.receive"),":"]})}),e.jsxs(s,{className:"self-stretch flex-1",children:[e.jsx(s,{flex:1,children:e.jsx(o,{className:"-ml-1 !text-2xl text-left flex-1",fontWeight:"normal",children:g})}),e.jsxs(s,{center:!0,className:"gap-3",children:[e.jsx(o,{textStyle:"subtitle2",children:A.ticker}),e.jsx(E,{asset:A,size:34})]})]})]})}),e.jsx($,{className:"self-stretch align-center !bg-light-bg-primary dark:!bg-dark-gray-light !rounded-2xl !py-2.5",children:e.jsxs(s,{alignCenter:!0,className:"flex-1 gap-2",justify:"between",children:[e.jsxs(s,{center:!0,className:"gap-2",children:[e.jsx(v,{className:"!p-1 !h-auto",leftIcon:e.jsx(w,{name:"switch",size:16}),onClick:()=>S(c=>!c),variant:"outlinePrimary"}),e.jsx(o,{fontWeight:"normal",textStyle:"caption",variant:"primary",children:de(x)})]}),e.jsx(V,{content:a("views.wallet.priceRate"),children:e.jsx(w,{className:Ve,color:"secondary",name:"infoCircle",size:20})})]})}),e.jsx(q,{action:n,assetValue:H.add(f),disabledButton:ge,ethAddress:j,handleVthorAction:xe,setIsConnectModalOpen:me})]}),e.jsx(J,{closeModal:ue,handleAction:B,isOpened:b,outputAmount:g,outputAsset:A,stakingAsset:H.add(f)})]})},fe=Q});export{ze as __tla,fe as default};
