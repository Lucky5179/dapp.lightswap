const __vite__fileDeps=["assets/index-POi8GhpC.js","assets/index-CWjS2nv2.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{cn as t,L as l,F as c,fj as Z,fk as h,dl as aa,dd as ea,_ as ta,e as ia,O as k,dm as v,cA as w,dk as S,df as sa,fn as E,fq as O,dp as R,ds as na,dq as p,dr as _,fl as P,fi as M,fs as L,__tla as ra}from"./assets/index-POi8GhpC.js";import{v as C}from"./Bb0RDO2T.js";let V,U,m,K,la=Promise.all([(()=>{try{return ra}catch{}})()]).then(async()=>{(function(){try{var a=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},o=new a.Error().stack;o&&(a._sentryDebugIds=a._sentryDebugIds||{},a._sentryDebugIds[o]="fb0786ef-2745-46d5-9bdd-0d2b76ef2f73",a._sentryDebugIdIdentifier="sentry-dbid-fb0786ef-2745-46d5-9bdd-0d2b76ef2f73")}catch{}})(),V=(a=>(a.Unstake="unstake",a.Deposit="deposit",a))(V||{});let I;U=a=>{const[o,T]=t.useState(new l({value:0,decimal:c.ETH})),b=t.useCallback(async()=>{if(a){const H=await Z(h.STAKING_THOR),{amount:d}=await H.userInfo(0,a);T(l.fromBigInt(d,c.ETH))}},[a]);return t.useEffect(()=>{b()},[b]),{stakedThorAmount:o,hasStakedV1Thor:o.gt(0)}},I=async()=>{const a=await(await M(E[O.THOR])).balanceOf(E[O.VTHOR]);return l.fromBigInt(a,18)},m=async(a,o)=>{try{const T=await(await M(L[h.VTHOR].address,L[h.VTHOR].abi))[a](...o??[])||0;return l.fromBigInt(T,c.ETH)}catch{return new l({value:0,decimal:c.ETH})}},K=()=>{const a=aa(),[o,T]=t.useState(new l({value:0,decimal:c.ETH})),[b,H]=t.useState(new l({value:0,decimal:c.ETH})),[d,N]=t.useState(new l({value:0,decimal:c.ETH})),[j,A]=t.useState(new l({value:0,decimal:c.ETH})),[G,$]=t.useState(new l({value:0,decimal:c.ETH})),{getWalletAddress:x}=ea(),s=t.useMemo(()=>x(ta.Ethereum),[x]),D=t.useCallback(async()=>{const e=await I();T(e);const n=await ia.get("https://api.thorswap.net/aggregator/stats/supply/circulating");H(new l(n))},[]),B=t.useCallback(async()=>{const e=await m("totalSupply");N(e)},[]),f=t.useCallback((e=!1)=>e?o.eqValue(0)?new l(1):d.div(o):d.eqValue(0)?new l(1):o.div(d),[o,d]),W=t.useCallback((e=!1)=>{const n=f(!e);return e?`1 vTHOR = ${n.toSignificant(4)} THOR`:`1 THOR = ${n.toSignificant(4)} vTHOR`},[f]),z=t.useCallback(async()=>{if(!s)return;const e=k.fromChainOrSignature("ETH.THOR"),n=C();a(v({id:n,from:s,label:`${w("txManager.approve")} ${e.ticker}`,inChain:e.chain,type:S.ETH_APPROVAL}));const{approveAssetValue:u}=await(await sa(()=>import("./assets/index-POi8GhpC.js").then(async i=>(await i.__tla,i)).then(i=>i.hc),__vite__mapDeps([0,1]))).getSwapKitClient();try{const i=await u(e,E[O.VTHOR]);typeof i=="string"&&a(R({id:n,txid:i}))}catch(i){na(i),a(p({id:n,status:"error"})),_(w("notification.approveFailed"),void 0,void 0,i)}},[s,a]),J=t.useCallback(e=>e.mul(f(!0)).toSignificant(),[f]),Q=t.useCallback(e=>e.mul(f()).toSignificant(),[f]),q=t.useCallback(async()=>{if(!s){$(new l({value:0,decimal:c.ETH}));return}const e=await m("balanceOf",[s]);$(e)},[s]),F=t.useCallback(async()=>{if(!s){A(new l({value:0,decimal:c.ETH}));return}const e=await m("balanceOf",[s]),n=await m("previewRedeem",[e]);return A(n)},[s]),y=t.useCallback(()=>{D(),B(),F(),s&&q()},[D,B,F,s,q]),X=t.useCallback(async(e,n)=>{if(e.eq(0))return;const u=C(),i=k.fromChainOrSignature("ETH.THOR",e.getValue("string"));if(a(v({id:u,from:s,label:`${w("txManager.stake")} ${e.toSignificant()} ${i.ticker}`,inChain:i.chain,type:S.ETH_STATUS})),!s)throw new Error("No ETH address");let g;try{g=await P(h.VTHOR,"deposit",[e.getBaseValue("bigint"),n])}catch(r){return _(w("notification.stakeFailed"),(r==null?void 0:r.message)||(r==null?void 0:r.toString()),void 0,r),a(p({id:u,status:"error"}))}a(g?R({id:u,txid:g}):p({id:u,status:"mined"}))},[a,s]),Y=t.useCallback(async(e,n)=>{const u=k.fromChainOrSignature("ETH.vTHOR",e.getValue("string")),i=C();a(v({id:i,from:s,label:`${w("txManager.unstake")} ${e.toSignificant()} ${u.ticker}`,inChain:u.chain,type:S.ETH_STATUS}));let g;try{g=await P(h.VTHOR,"redeem",[e.getBaseValue("bigint"),n,n])}catch(r){return _(w("notification.stakeFailed"),(r==null?void 0:r.message)||(r==null?void 0:r.toString()),void 0,r),a(p({id:i,status:"error"}))}a(g?R({id:i,txid:g}):p({id:i,status:"mined"}))},[a,s]);return t.useEffect(()=>y(),[y]),{thorStaked:o,thorRedeemable:j,stakePercentageRate:b.gt(0)?o.div(b).mul(100).getValue("number").toFixed(2):0,vthorBalance:G,vthorTS:d,getRate:f,getRateString:W,approveTHOR:z,handleRefresh:y,previewDeposit:J,previewRedeem:Q,stakeThor:X,unstakeThor:Y}}});export{V as S,la as __tla,U as a,m as g,K as u};
