const __vite__fileDeps=["assets/index-POi8GhpC.js","assets/index-CWjS2nv2.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{cn as e,cv as a,cJ as x,cL as F,cy as Se,cA as s,cV as f,cS as dt,cz as C,cM as ut,di as q,dl as mt,dt as pt,dd as ht,dH as ft,ef as gt,_ as b,O as xt,ee as yt,du as bt,L as D,dI as vt,dm as B,dk as W,df as je,dp as G,ds as _e,dq as Y,dr as Pe,dw as ke,eK as J,cP as X,__tla as wt}from"./assets/index-POi8GhpC.js";import{G as At}from"./BwAMgJ-H.js";import{I as Me}from"./L2srWHi_.js";import{C as Te,__tla as Ct}from"./Bujnyu6O.js";import{u as St}from"./C3OMHbbi.js";import{P as jt}from"./C2Mbex37.js";import{V as _t}from"./BNG_iicX.js";import{u as Pt}from"./DLie8hhL.js";import{g as kt}from"./CGri0DVm.js";import{i as Mt,u as Tt,g as Ne}from"./DdtGuP0z.js";import{u as Nt}from"./CNj6CspX.js";import{u as Lt}from"./Bcp9QaNf.js";import{c as Vt}from"./CNwSF2cA.js";import{L as H}from"./zJSzH3N0.js";import{u as Rt}from"./PxwVcihW.js";import{u as qt,__tla as Dt}from"./Bm7XAPj_.js";import{u as Et}from"./Cpj0Wy6v.js";import{A as Le}from"./BNvyzkU_.js";import{u as Ot}from"./BIRMHJJ4.js";import{v as Q}from"./Bb0RDO2T.js";import"./C8rAcL73.js";import"./CZ5SrGDV.js";import"./C6gN5CZK.js";import"./CJGo2KxJ.js";import"./CYwjOChi.js";import"./DtctggWu.js";let Ve,Ut=Promise.all([(()=>{try{return wt}catch{}})(),(()=>{try{return Ct}catch{}})(),(()=>{try{return Dt}catch{}})()]).then(async()=>{(function(){try{var c=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},m=new c.Error().stack;m&&(c._sentryDebugIds=c._sentryDebugIds||{},c._sentryDebugIds[m]="88e2fac2-bcf6-4c69-8783-1fa8b99250ce",c._sentryDebugIdIdentifier="sentry-dbid-88e2fac2-bcf6-4c69-8783-1fa8b99250ce")}catch{}})();let Z,ee,te;Z=e.memo(({poolAsset:c,runeAsset:m,poolAssetList:v,onAssetAmountChange:S,onRuneAmountChange:j,onPoolChange:N,liquidityType:y,isAssetPending:d,isRunePending:u})=>{const{assetInputProps:k,assets:E}=Ot(v);return a.jsxs(x,{col:!0,className:"relative self-stretch w-full",children:[a.jsx(x,{className:F("absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2","p-1 md:p-2 rounded-xl md:rounded-[18px]","border-10 border-solid bg-blue dark:border-dark-border-primary border-light-border-primary","opacity-100 scale-100 transition-all",{"!scale-0 !opacity-0":y!==H.SYMMETRICAL}),children:a.jsx(Se,{className:F("w-7 h-7"),color:"white",name:"plus"})}),a.jsx(x,{className:F("overflow-hidden h-[111px] transition-all",{"!h-[0px]":y===H.RUNE}),children:a.jsx(Le,{...k,assets:E,className:"!mb-1 flex-1",disabled:d,maxButtonLabel:u?s("pendingLiquidity.complete"):"",onAssetChange:N,onValueChange:S,selectedAsset:c,warning:d?s("pendingLiquidity.content",{asset:f.ticker}):""})}),a.jsx(x,{className:F("overflow-hidden h-[111px] transition-all",{"!h-[0px]":y===H.ASSET}),children:a.jsx(Le,{singleAsset:!0,className:"!mb-1 flex-1",disabled:u,maxButtonLabel:d?s("pendingLiquidity.complete"):"",onValueChange:j,selectedAsset:m,warning:u?s("pendingLiquidity.content",{asset:c.asset.ticker}):""})})]})}),ee=({poolAsset:c,runeAsset:m,poolShare:v,assetUSDPrice:S,rate:j})=>a.jsx(dt,{className:"self-stretch !mt-0 !bg-light-gray-light dark:!bg-dark-gray-light !rounded-2xl flex-col",shadow:!1,title:a.jsxs("div",{className:"flex flex-row gap-x-2",children:[a.jsx(Se,{color:"secondary",name:"infoCircle",size:16}),a.jsx(C,{fontWeight:"normal",textStyle:"caption",variant:"primary",children:s("views.addLiquidity.pricesAndPoolShare")})]}),children:a.jsxs(x,{row:!0,className:"w-full",children:[a.jsxs(x,{col:!0,className:"flex-1 gap-2 border-0 border-r border-dotted border-light-typo-gray dark:border-dark-typo-gray",children:[a.jsxs(C,{fontWeight:"semibold",textStyle:"caption",variant:"secondary",children:[c.asset.ticker,` ${s("common.per")} `,m.asset.ticker]}),a.jsx(C,{textStyle:"h4",children:j||"N/A"})]}),a.jsxs(x,{col:!0,className:"flex-1 gap-2 text-center border-0 border-r border-dotted border-light-typo-gray dark:border-dark-typo-gray",children:[a.jsx(C,{fontWeight:"semibold",textStyle:"caption",variant:"secondary",children:s("views.liquidity.assetUSDPrice")}),a.jsx(C,{textStyle:"h4",children:S||"N/A"})]}),a.jsxs(x,{col:!0,className:"flex-1 gap-2 text-right",children:[a.jsx(C,{fontWeight:"semibold",textStyle:"caption",variant:"secondary",children:s("views.addLiquidity.shareOfPool")}),a.jsx(C,{textStyle:"h4",children:v||"N/A"})]})]})}),te=({assets:c,fees:m,totalFee:v,poolShare:S,slippage:j,estimatedTime:N})=>{const y=c.map(u=>({label:`${s("views.liquidity.depositAmount")} ${u.asset.symbol}`,value:a.jsxs(x,{alignCenter:!0,justify:"between",children:[a.jsx(C,{className:"mx-2",fontWeight:"semibold",children:u.value}),a.jsx(ut,{asset:u.asset,size:24})]})})),d=m.map(u=>({label:`${u.chain} ${s("common.fee")}`,value:a.jsx(q,{tooltip:s("views.liquidity.chainFeeTooltip",{chain:u.chain}),value:u.fee})}));return[...y,{label:s("views.wallet.slip"),value:a.jsx(q,{tooltip:s("views.wallet.slippageTooltip"),value:j||"N/A"})},{label:s("views.liquidity.poolShareEstimated"),value:a.jsx(q,{tooltip:s("views.liquidity.poolShareTooltip"),value:S})},...d,{label:s("views.wallet.totalFee"),value:a.jsx(q,{tooltip:s("views.wallet.totalFeeTooltip"),value:v||"N/A"})},{label:s("views.wallet.estimatedTime"),value:a.jsx(q,{tooltip:s("views.wallet.estimatedTimeTooltip"),value:N})}]},Ve=()=>{const c=mt(),[m,v]=e.useState([]),[S,j]=e.useState(""),{setIsConnectModalOpen:N}=pt(),{hasWallet:y,wallet:d,getWallet:u}=ht(),{poolAssets:k}=Lt(),E=Et("pools"),{tokens:Re}=ft(),O=gt(),qe=Pt(),ae=e.useMemo(()=>{var n;const o=[];if(!y)return k;if(k.length===0)return[];for(const l of Object.keys(d)){const r=((n=u(l))==null?void 0:n.balance)||[];if(b.THORChain!==l)for(const h of r)!k.find(P=>P.eqAsset(h))&&h.chain!==b.THORChain&&Mt(h,E)&&o.push(h)}return o},[E,u,y,k,d]),se=e.useCallback(async o=>{const n=await Vt()||[],{router:l,halted:r}=n.find(h=>h.chain===o)||{};if(r&&!l)throw new Error("Trading & LP is temporarily halted, please try again later.");j(l||"")},[]),ie=e.useCallback(()=>{if(y){const o=ae.filter(n=>n.ticker!=="RUNE"&&!n.isSynthetic)||[];v(o)}else v([])},[ae,y]);e.useEffect(()=>{ie()},[ie]);const[t,De]=e.useState((m==null?void 0:m[0])??xt.from({chain:b.Bitcoin})),{getMaxBalance:U,isWalletAssetConnected:oe}=Tt(),{isChainPauseLPAction:ne}=yt(),{getChainDepositLPPaused:le}=bt(),re=e.useMemo(()=>ne(t.chain)||le(t.chain),[ne,t.chain,le]),[i,ce]=e.useState(),[p,de]=e.useState(new D(0)),[Ee,z]=e.useState(!1),[Oe,$]=e.useState(!1),[w,Ue]=e.useState(),[A,Ie]=e.useState(f),{feeInUSD:Fe,inputFee:ue,outputFee:We}=Nt({inputAsset:t,outputAsset:f}),I=e.useMemo(()=>!!u(t.chain),[t,u]),L=e.useMemo(()=>I&&!!u(b.THORChain),[I,u]),He=e.useMemo(()=>t.set((i==null?void 0:i.getValue("string"))||0),[t,i]),{isApproved:me,isLoading:ze}=qt({contract:S,assetValue:He}),$e=e.useMemo(()=>[t,f],[t]),{data:_}=vt($e),{assetUnitPrice:M,runeUnitPrice:T,assetUSDPrice:K,runeUSDPrice:pe}=e.useMemo(()=>{var l,r;const o=((l=_==null?void 0:_[t.toString()])==null?void 0:l.price_usd)||0,n=((r=_==null?void 0:_[f.toString()])==null?void 0:r.price_usd)||0;return{assetUnitPrice:o,runeUnitPrice:n,assetUSDPrice:i?i.getValue("number")*o:0,runeUSDPrice:p?p.getValue("number")*n:0}},[_,t,i,p]),Ke=e.useMemo(()=>i!=null&&i.lte(0)?i.set(0):i?p.div(i):p,[i,p]),he=e.useMemo(()=>d?Ne(t,d):t.set(0),[t,d]);e.useEffect(()=>{se(t.chain)},[se,t.chain]),e.useEffect(()=>{U(i?t.set(i):t).then(o=>Ue(o))},[t,U,i]),e.useEffect(()=>{U(f.set(p)).then(o=>Ie(o))},[U,p]);const fe=e.useMemo(()=>d?Ne(f,d):f.set(0),[d]),Be=e.useCallback(o=>{De(o)},[]),ge=e.useCallback(o=>{const n=w&&o.gt(w)?w:t.set(o.getValue("string")),l=n.mul(M).div(T),r=A&&l.gt(A),h=r?A:l;return{assetAmount:r?n.set(h.mul(T).div(M)):n,runeAmount:h}},[M,w,A,t,T]),xe=e.useCallback(o=>{const n=A&&o.gt(A)?A:f.set(o.getValue("string")),l=n.mul(T).div(M),r=w&&l.gt(w),h=r?w:l,P=r?n.set(h.mul(M).div(T)):n;return{assetAmount:h,runeAmount:P}},[M,w,A,T]),Ge=e.useCallback(o=>{const{assetAmount:n,runeAmount:l}=ge(o);ce(new D({value:n.getValue("string"),decimal:n.decimal})),de(new D({value:l.getValue("string"),decimal:l.decimal}))},[ge]),Ye=e.useCallback(o=>{const{assetAmount:n,runeAmount:l}=xe(o);ce(new D({value:n.getValue("string"),decimal:n.decimal})),de(new D({value:l.getValue("string"),decimal:l.decimal}))},[xe]),Je=e.useCallback(async()=>{if(z(!1),d){const o=f.set(p.getValue("string")),n=t.set((i==null?void 0:i.getValue("string"))||0),l=Q(),r=Q();c(B({id:l,label:s("txManager.addAmountAsset",{asset:f.ticker,amount:o.toSignificant(6)}),type:W.TC_LP_ADD,inChain:b.THORChain})),c(B({id:r,label:s("txManager.addAmountAsset",{asset:t.ticker,amount:n.toSignificant(6)}),type:W.TC_LP_ADD,inChain:t.chain}));let h,P;const{thorchain:Ce}=await(await je(()=>import("./assets/index-POi8GhpC.js").then(async g=>(await g.__tla,g)).then(g=>g.hc),__vite__mapDeps([0,1]))).getSwapKitClient();if(!Ce)throw new Error("SwapKit client not found");try{const g=await Ce.createLiquidity({baseAssetValue:o,assetValue:n});h=await g.runeTx,P=await g.assetTx,h&&c(G({id:l,txid:h})),P&&c(G({id:r,txid:P}))}catch(g){_e(g),c(Y({id:l,status:"error"})),c(Y({id:r,status:"error"})),Pe(s("notification.submitFail"),g==null?void 0:g.toString(),void 0,g)}}},[d,p,t,i,c]),Xe=e.useCallback(async()=>{if($(!1),oe(t)){const o=Q(),n=t.chain===b.Ethereum?W.ETH_APPROVAL:W.AVAX_APPROVAL;c(B({id:o,label:`${s("txManager.approve")} ${t.ticker}`,inChain:t.chain,type:n}));const{thorchain:l}=await(await je(()=>import("./assets/index-POi8GhpC.js").then(async r=>(await r.__tla,r)).then(r=>r.hc),__vite__mapDeps([0,1]))).getSwapKitClient();if(!l)throw new Error("SwapKit client not found");try{const r=await l.approveAssetValue({assetValue:t});typeof r=="string"&&c(G({id:o,txid:r}))}catch(r){_e(r),Pe(s("notification.approveFailed"),void 0,void 0,r),c(Y({id:o,status:"error"}))}}},[oe,t,c]),Qe=e.useCallback(()=>{if(!L)return ke(s("notification.walletNotFound"),s("notification.connectWallet"));z(!0)},[L]),Ze=e.useCallback(()=>{d?$(!0):ke(s("notification.walletNotFound"),s("notification.connectWallet"))},[d]),et=e.useMemo(()=>[t,f],[t]),tt=e.useMemo(()=>[{asset:f,value:p.toSignificant(6)},{asset:t,value:(i==null?void 0:i.toSignificant(6))||""}],[t,i,p]),ye=e.useMemo(()=>J(b.THORChain),[]),be=e.useMemo(()=>t.isGasAsset?J(t.chain):J(b.THORChain),[t]),V=e.useMemo(()=>re?{valid:!1,msg:s("notification.notAvailableDeposit")}:m.length===0?{valid:!1,msg:s("notification.assetNotFound")}:p.gt(ye)&&(i!=null&&i.gt(be))?{valid:!0}:{valid:!1,msg:s("notification.invalidAmount")},[re,p,i,ye,be,m]),R=e.useMemo(()=>I&&me===!1,[I,me]),ve=e.useMemo(()=>({asset:t,value:i,balance:he,usdPrice:K}),[t,i,he,K]),we=e.useMemo(()=>({asset:f,value:p,balance:fe,usdPrice:pe}),[p,fe,pe]),Ae=Rt(Re),at=e.useMemo(()=>Ae.filter(o=>m.some(n=>n.toString().toUpperCase()===o.asset.toString().toUpperCase())),[Ae,m]),st=e.useMemo(()=>`${s("common.create")} ${t.ticker} ${s("common.liquidity")}`,[t]),it=e.useMemo(()=>V.valid?R?s("common.create"):s("common.createLiquidity"):V.msg,[V,R]),ot=e.useMemo(()=>kt({chain:t.chain,amount:i}),[i,t]),nt=te({assets:tt,poolShare:"100%",slippage:"N/A",estimatedTime:ot,totalFee:Fe,fees:[{chain:t.chain,fee:ue.toSignificant()},{chain:b.THORChain,fee:We.toSignificant()}]}),lt=St({assetName:t.ticker,assetValue:(i==null?void 0:i.toSignificant(6))||"0",fee:ue.toSignificant()}),rt=e.useMemo(()=>L&&!R,[L,R]),ct=e.useMemo(()=>a.jsx(At,{}),[]);return a.jsxs(jt,{header:a.jsx(_t,{actionsComponent:ct,title:s("common.createLiquidity")}),title:st,children:[a.jsx(Z,{isAssetPending:!1,isRunePending:!1,liquidityType:H.SYMMETRICAL,onAssetAmountChange:Ge,onPoolChange:Be,onRuneAmountChange:Ye,poolAsset:ve,poolAssetList:at,runeAsset:we}),a.jsx(ee,{assetUSDPrice:qe(K),poolAsset:ve,poolShare:"100%",rate:Ke.toSignificant(6),runeAsset:we}),R&&a.jsx(x,{className:"w-full pt-5",children:a.jsx(X,{stretch:!0,error:O,loading:ze,onClick:Ze,size:"lg",tooltip:O?s("views.liquidity.hardCapReachedTooltip"):void 0,variant:"fancy",children:s("common.approve")})}),rt&&a.jsx(x,{className:"w-full pt-5",children:a.jsx(X,{stretch:!0,disabled:!V.valid,error:!V.valid||O,onClick:Qe,size:"lg",tooltip:O?s("views.liquidity.hardCapReachedTooltip"):void 0,variant:"fancy",children:it})}),!L&&a.jsx(x,{className:"w-full pt-5",children:a.jsx(X,{stretch:!0,onClick:()=>N(!0),size:"lg",variant:"fancy",children:s("common.connectWallet")})}),a.jsx(Te,{inputAssets:et,isOpened:Ee,onClose:()=>z(!1),onConfirm:Je,children:a.jsx(Me,{items:nt})}),a.jsx(Te,{inputAssets:[t],isOpened:Oe,onClose:()=>$(!1),onConfirm:Xe,children:a.jsx(Me,{items:lt})})]})}});export{Ut as __tla,Ve as default};
